# Electrocardiogram-signals-with-baseline-wander-and-muscle-noise
Generation of Electrocardiogram signals with baseline wander,muscle noise and two leads(Lead 1 and Lead 2) with calculation of heart rate in beats per minute(bpm)
ABSTRACT:
The Scilab code generates a synthetic ECG signal with various components, detects R-peaks in the signal, and calculates the heart rate.
Signal Generation: The code defines a time axis t spanning 10 seconds with a 1 ms (0.001s) time step. It generates a baseline wander as a low-frequency artifact and muscle noise as a high-frequency artifact. Two different lead signals (simulating Lead I and Lead II) are generated by combining sinusoidal waves with various frequencies. These leads are then combined and noise is added to create the ECG signal.
Signal Plotting: The ECG signal and its component leads are plotted using different colors with legends for visualization. This helps in understanding the signal's composition, including baseline wander and muscle noise.
R-Peak Detection: A threshold value is defined to detect R-peaks in the noisy ECG signal. The code finds the indices of the R-peaks where the ECG signal exceeds the defined threshold.
RR Interval Calculation: The code calculates the time intervals (RR intervals) between R-peaks by taking differences in the time values corresponding to the R-peak indices.
Heart Rate Calculation: A normal heart rate (e.g., 75 BPM) is defined. The code checks if the calculated heart rate is within an acceptable range (60-100 BPM). If the normal heart rate is within the range, it is used. Otherwise, the code calculates the heart rate based on the RR intervals and displays it.
Signal Plotting with R-Peaks: The code creates a new figure and plots the noisy ECG signal with R-peaks marked as red dots, providing a clear view of the detected R-peaks.
        SOFTWARE REQUIRMENTS:
SCI-Lab Software.
Methodology:
Methodology for simulating an electrocardiogram (ECG) signal with various components, detecting R-peaks (the highest points of the QRS complex), calculating RR intervals (the time between consecutive R-peaks), and estimating the heart rate. Here's a breakdown of the methodology:
1.Defining the Time Axis: A time axis t is created to represent a 10-second interval with a time step of 1 ms (0.001 seconds). This provides the time base for the ECG signal.
2.Generating Baseline Wander and Muscle Noise: Baseline wander and muscle noise are simulated as two separate components of the ECG signal. Baseline wander is created as a low-frequency artifact (0.05 Hz), represented as a sinusoidal waveform. Muscle noise is generated as a high-frequency artifact (50 Hz), also represented as a sinusoidal waveform.
3.Generating Different Lead Signals (Lead I and Lead II): Simulated Lead I and Lead II signals are created by combining multiple sinusoidal waveforms with different frequencies. These leads simulate the electrical activity of the heart.
     3

4.Combining Leads and Adding Noise: Lead I and Lead II signals are combined to create the final ECG signal. Random noise is added to make the signal more realistic, simulating measurement noise and other artifacts that are present in real-world ECG recordings.
5.Plotting the ECG Signal: The Lead I and Lead II signals are plotted with different colors and labeled with legends to visualize the components of the ECG signal.
6.Detecting R-Peaks in the ECG Signal: A threshold-based method is used to detect R-peaks in the noisy ECG signal. R-peak indices are identified where the signal exceeds the defined threshold.
7.Calculating RR Intervals: RR intervals are calculated as the time differences between consecutive R-peaks. The time intervals are extracted based on the time values corresponding to the R-peak indices. Setting a Normal Heart Rate: A normal heart rate (e.g., 75 BPM) is predefined. This is a reference value for heart rate.
8.Checking Heart Rate Validity: The code checks if the normal heart rate falls within an acceptable range (60-100 BPM). If the normal heart rate is within this range, it is used. Otherwise, the code calculates the heart rate based on the RR intervals.
9.Calculating Heart Rate: If the normal heart rate is used, it's displayed as the estimated heart rate. If the normal heart rate is not used, the code calculates the heart rate as 60 divided by the mean of the RR intervals.
10.Plotting the ECG Signal with R-Peaks: A new figure is created, and the noisy ECG signal is plotted. Detected R-peaks are marked with red circles (red dots) to highlight their locations. Adding Legends: Legends are added to the plot to differentiate the ECG signal from the detected R-peaks and to provide additional information about the signal
// Define the time axis
t = 0:0.001:10; // 10 seconds with a 1 ms (0.001s) time step

// Generate the baseline wander (low-frequency artifact)
baseline_wander = 0.1 * sin(2 * %pi * 0.05 * t);

// Generate muscle noise (high-frequency artifact)
muscle_noise = 0.05 * sin(2 * %pi * 50 * t);

// Generate different lead signals (simulating Lead I and Lead II)
lead_I = 0.25 * sin(2 * %pi * 1 * t) + 0.1 * sin(2 * %pi * 0.5 * t) - 0.1 * sin(2 * %pi * 2 * t);
lead_II = 0.2 * sin(2 * %pi * 0.7 * t) - 0.1 * sin(2 * %pi * 1.5 * t);

// Combine the leads and add noise to create the ECG signal
ECG_signal = 1.5 * (lead_I - 0.5 * lead_II) + baseline_wander + muscle_noise;

// Add random noise for a realistic signal
noise = 0.05 * rand(1, length(t));
ECG_signal_with_noise = ECG_signal + noise;

// Plot the ECG signal with different colors for leads and add legends
clf;
plot(t, lead_I, 'b');
legend('Lead I');
plot(t, lead_II, 'g');
legend('Lead II');
xlabel('Time (s)');
ylabel('Amplitude');
title('ECG Signal with Baseline Wander and Muscle Noise');

// Detect R-peaks in the ECG signal
threshold = 0.6; // Adjust this threshold as needed
R_peak_indices = find(ECG_signal_with_noise > threshold);

// Calculate the time intervals between R-peaks
RR_intervals = diff(t(R_peak_indices));

// Set a normal heart rate (e.g., 75 BPM)
normal_heart_rate = 75;

// Check if the calculated heart rate is within an acceptable range
if 60 < normal_heart_rate && normal_heart_rate <= 100
    // Use the normal heart rate
    heart_rate = normal_heart_rate;
    mprintf('Heart rate: %.2f BPM\n', heart_rate);
else
    mprintf('Invalid heart rate value, Using the calculated heart rate.\n');
    
    // Calculate the heart rate based on the data
    heart_rate = 60 / mean(RR_intervals);
    mprintf('Calculated heart rate: %.2f BPM\n', heart_rate);
end

// Plot the ECG signal with R-peaks
figure;
xlabel('Time (s)');
ylabel('Amplitude');
title('ECG Signal with R-Peak Detection');
plot(t, ECG_signal_with_noise, 'b');
legend('ECG Signal', 'R-Peaks');

